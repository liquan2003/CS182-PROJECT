# 股价预测模型结果分析

## 概述
本分析旨在评估不同方法（LSTM、CNN+LSTM、XGBoost）在加入情绪因子前后的表现，并探讨其原因。分析基于MAE（平均绝对误差）和RMSE（均方根误差）两个指标。

## 数据集
- **APPL**：苹果公司股票数据
- **GOOGL**：谷歌公司股票数据
- **MSFT**：微软公司股票数据

## 方法
1. **LSTM（长短期记忆网络）**
2. **CNN+LSTM（卷积神经网络+长短期记忆网络）**
3. **XGBoost（极端梯度提升）**

## 横向分析：按是否加入情绪因子

### 1. LSTM
- **原理**：LSTM是一种特殊的循环神经网络（RNN），通过引入“门”机制来控制信息的流动，避免梯度消失问题，特别适合处理时间序列数据。
- **结果**：
  - **未加入情绪因子**：
    - **APPL**: MAE = 0.0067, RMSE = 0.0078
    - **GOOGL**: MAE = 0.0112, RMSE = 0.0113
    - **MSFT**: MAE = 0.0122, RMSE = 0.0123
  - **加入情绪因子**：
    - **APPL**: MAE = 0.0055, RMSE = 0.0055
    - **GOOGL**: MAE = 0.0112, RMSE = 0.0113
    - **MSFT**: MAE = 0.0122, RMSE = 0.0123
- **分析**：
  - **APPL**数据集：加入情绪因子后，MAE和RMSE显著降低，表明情绪因子对APPL的股价预测有显著帮助。
  - **GOOGL**和**MSFT**数据集：加入情绪因子后，MAE和RMSE变化不大，表明情绪因子对这两个数据集的影响较小。

### 2. CNN+LSTM
- **原理**：CNN+LSTM结合了卷积神经网络（CNN）的空间特征提取能力和LSTM的时间特征提取能力，适合处理具有时间和空间特征的数据。
- **结果**：
  - **未加入情绪因子**：
    - **APPL**: MAE = 0.0087, RMSE = 0.0099
    - **GOOGL**: MAE = 0.0073, RMSE = 0.0081
    - **MSFT**: MAE = 0.0132, RMSE = 0.0141
  - **加入情绪因子**：
    - **APPL**: MAE = 0.0066, RMSE = 0.0066
    - **GOOGL**: MAE = 0.0102, RMSE = 0.0103
    - **MSFT**: MAE = 0.0137, RMSE = 0.0138
- **分析**：
  - **APPL**数据集：加入情绪因子后，MAE和RMSE显著降低，表明情绪因子对APPL的股价预测有显著帮助。
  - **GOOGL**数据集：加入情绪因子后，MAE和RMSE略有降低，但变化不大。
  - **MSFT**数据集：加入情绪因子后，MAE和RMSE变化不大，表明情绪因子对MSFT的股价预测帮助有限。

### 3. XGBoost
- **原理**：XGBoost是一种基于梯度提升的集成学习方法，通过组合多个弱学习器（通常是决策树）来构建一个强学习器，适合处理结构化数据。
- **结果**：
  - **未加入情绪因子**：
    - **APPL**: MAE = 0.0013, RMSE = 0.0017
    - **GOOGL**: MAE = 0.0053, RMSE = 0.0072
    - **MSFT**: MAE = 0.0025, RMSE = 0.0032
  - **加入情绪因子**：
    - **APPL**: MAE = 0.0066, RMSE = 0.0066
    - **GOOGL**: MAE = 0.0102, RMSE = 0.0103
    - **MSFT**: MAE = 0.0137, RMSE = 0.0138
- **分析**：
  - **APPL**数据集：加入情绪因子后，MAE和RMSE显著增加，表明情绪因子对XGBoost模型的预测性能有负面影响。
  - **GOOGL**和**MSFT**数据集：加入情绪因子后，MAE和RMSE显著增加，表明情绪因子对XGBoost模型的预测性能有负面影响。

## 纵向分析：按方法

### 1. 未加入情绪因子
- **LSTM**：
  - **APPL**: MAE = 0.0067, RMSE = 0.0078
  - **GOOGL**: MAE = 0.0112, RMSE = 0.0113
  - **MSFT**: MAE = 0.0122, RMSE = 0.0123
- **CNN+LSTM**：
  - **APPL**: MAE = 0.0087, RMSE = 0.0099
  - **GOOGL**: MAE = 0.0073, RMSE = 0.0081
  - **MSFT**: MAE = 0.0132, RMSE = 0.0141
- **XGBoost**：
  - **APPL**: MAE = 0.0013, RMSE = 0.0017
  - **GOOGL**: MAE = 0.0053, RMSE = 0.0072
  - **MSFT**: MAE = 0.0025, RMSE = 0.0032
- **分析**：
  - XGBoost均表现最佳，MAE和RMSE最低。

### 2. 加入情绪因子
- **LSTM**：
  - **APPL**: MAE = 0.0055, RMSE = 0.0055
  - **GOOGL**: MAE = 0.0112, RMSE = 0.0113
  - **MSFT**: MAE = 0.0122, RMSE = 0.0123
- **CNN+LSTM**：
  - **APPL**: MAE = 0.0066, RMSE = 0.0066
  - **GOOGL**: MAE = 0.0102, RMSE = 0.0103
  - **MSFT**: MAE = 0.0137, RMSE = 0.0138
- **XGBoost**：
  - **APPL**: MAE = 0.0066, RMSE = 0.0066
  - **GOOGL**: MAE = 0.0102, RMSE = 0.0103
  - **MSFT**: MAE = 0.0137, RMSE = 0.0138
- **分析**：
  - LSTM表现最佳，MAE和RMSE最低。 CNN+LSTM 和 XGBoost表现接近
  

## 总结
1. **未加入情绪因子时**：
   - **XGBoost**在所有数据集上表现最佳，MAE和RMSE最低。
   - **LSTM**和**CNN+LSTM**的表现相对较高，但仍有较好的预测性能。

2. **加入情绪因子后**：
   - **APPL**数据集：**LSTM**表现最佳，MAE和RMSE显著降低。
   - **GOOGL**和**MSFT**数据集：**LSTM**表现最佳，但MAE和RMSE变化不大。
   - **XGBoost**在加入情绪因子后，MAE和RMSE显著增加，表明情绪因子对模型性能有负面影响。

3. **情绪因子的影响**：
   - **APPL**数据集：加入情绪因子后，模型性能显著提升。
   - **GOOGL**和**MSFT**数据集：加入情绪因子后，模型性能提升有限或甚至下降。

4. **CNN_LSTM&LSTM模型**：
   - CNN_LSTM先用CNN提取局部空间特征，再用LSTM建模时序关系。单纯的LSTM仅处理一维时间序列数据（如每日股价）。通过记忆单元捕捉长期依赖关系，适合学习时间步之间的模式。
   - 由于本次数据是单一时间序列（仅收盘价），且趋势平滑、噪声少。 LSTM有时表现甚至超过CNN_LSTM实际应用中，但CNN-LSTM在捕捉股价的短期技术形态上通常优于纯LSTM
   - 而在加入情绪因子后，CNN_LSTM的提升比纯LSTM幅度更大，则是得益于CNN层的对多个特点的卷积。

5. **XGBoost**:
   - XGBoost是基于决策树的梯度提升集成学习算法而LSTM和CNN-LSTM属于深度学习中的循环神经网络。这是根本性的差异，一个是树模型，一个是神经网络。
   - XGBoost擅长处理结构化特征数据，可以方便地加入技术指标、日期特征等，而LSTM更适合处理纯时间序列数据


## 性能对比表
| 维度               | XGBoost                     | LSTM                        | CNN-LSTM                    |
|--------------------|-----------------------------|-----------------------------|-----------------------------|
| **预测精度**       | 单步预测优 (RMSE≈2.32)      | 多步预测强                  | 短期波动捕捉最佳           |
| **训练速度**       | ★★★ 快 (并行计算)           | ★★ 中等                     | ★ 慢 (双重结构)            |
| **数据需求**       | 适中 (需特征工程)           | 大量 (防过拟合)             | 海量+复杂优化              |
| **抗噪声能力**     | ★★ 中等                     | ★ 低 (对异常值敏感)         | ★★★ 高 (CNN滤波)           |
| **时序依赖建模**   | 弱 (需人工构造)             | 强 (自动学习)               | 极强 (时空联合建模)        |
| **特征工程依赖**   | 高                          | 低                          | 中                          |


6. **XGBoost在加入情绪因子后反而表现更差**
    - 情绪因子通常是非平稳尖峰分布（例如突发新闻导致情绪值骤变），而原始股价相对平滑
    - 决策树基于特征阈值分裂，情绪因子的极端值会生成无意义的分裂规则
